# 🚀 이번 주 개발 목표

> 2023.08.02 ~ 2023.08.08

## 윤수빈

- 보드게임 찜하기 및 취소하기 ✔️
- 보드게임 평가하기 ✔️
- 찜한 보드게임 조회하기
- 평가한 보드게임 조회하기 (전체 / 별점 별)

# 지금까지의 개발 과정 요약

> 윤수빈

- 새로 알게 된 점
    - 부모 엔티티를 통해 일대다 혹은 다대다 관계의 자식 엔티티를 저장하는 경우,
      `persist`와 `merge` 중 어느 것이 실행될 지는 부모 엔티티의 상태에 따라 결점됨.
- 어려웠던 점
  - `merge` 메서드가 실행 될 때, 자식 엔티티 클래스에 `Persistable` 인터페이스의 `isNew()`를 직접 구현함으로써 
    새로운 엔티티인 지 확인하는 절차를 거치도록 했음. 그러나 자식 엔티티에 대해서는 새로운 엔티티 확인을 `isNew()`가 아닌
    Spring Jpa 내부 로직에서 임의로 판단한다는 점을 찾아내기 어려웠음
- 정리
  - `isNew()` 메서드로 새로운 엔티티인 지 확인하는 것은 `save`하는 엔티티에 대해서만 판별할 때 사용되고,
    그에 연결된 자식 엔티티들에 대해선 Jpa 내부 로직에서 자체적으로 판단함. 즉, `merge`일 때 자식 엔티티가 새로운 엔티티인 지는
    `DefaultMergeEventListener`가 담당하는 데 만약 자식 엔티티의 PK가 자동 생성 전략을 따르지 않는 값이라면 엔티티의 상태를
    `TRANSIENT`가 아닌 `DETACHED`로 판단함. 따라서 DB에 실제로 존재하는 지 확인하기 위해 `select` 쿼리를 실행한 뒤 `insert`하게 됨.